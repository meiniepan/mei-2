<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no">
    <meta name="format-detection" content="telephone=yes"/>
    <meta http-equiv="Access-Control-Allow-Origin" content="*" />
    <title></title>
    <script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
    <!--<script src="https://unpkg.com/ipfs/dist/index.js"></script>-->
    <script src="https://unpkg.com/ipfs-api/dist/index.js"></script>
</head>
<body>
<div id="app"></div>
<!-- built files will be auto injected -->

</body>
<script>
  var ipfs = window.IpfsApi({host: '192.168.1.186', port: '5001', protocol: 'http'});
  // Ready to use!
  // See https://github.com/ipfs/js-ipfs#core-api
  console.error("hhhhhhhhhhhhhhhhhhhhhhhhhhh");
  let content = ipfs.types.Buffer.from('/assets/img/demo.jpg');
  let res = ipfs.files.add(content)
    .then((results) => console.error(results[0].hash));

  const createFiles = (directory) => {
    return [{
      content: ipfs.types.Buffer.from('one', 'utf8'),
      path: 'cg.png'
    }]
  };

  const streamFiles = (directory, files, cb) => {
    const stream = ipfs.files.addReadableStream();
    stream.on('data', function (data) {
    });

    files.forEach(file => stream.write(file));

    stream.end();
  };

  const directory = 'directory';
  const files = createFiles(directory);

  streamFiles(directory, files, (err, directoryHash) => {
    ipfs.ls(directoryHash, (err, files) => {
      files.forEach((file, index) => {
      })
    })
  });

</script>
</html>
